{% load jalali_filters %}
<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <title>گزارشات</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">گزارشات سفارشات</h1>
        
        <h2>تعداد کل افراد شرکت کننده در همه روضه ها</h2>
        <p>{{ total_attendees }}</p>

        <h2>آمار سفارشات هر شهر</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>شهر</th>
                    <th>تعداد سفارشات</th>
                </tr>
            </thead>
            <tbody>
                {% for city in city_stats %}
                <tr>
                    <td>{{ city.city }}</td>
                    <td>{{ city.count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>تعداد سفارشات با توجه به مدرک تحصیلی (حداقل مدرک تحصیلی افراد شرکت کننده)</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>حداقل مدرک تحصیلی</th>
                    <th>تعداد سفارشات</th>
                </tr>
            </thead>
            <tbody>
                {% for education in education_min_stats %}
                <tr>
                    <td>{{ education.education_min_attendees }}</td>
                    <td>{{ education.count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>تعداد سفارشات با توجه به مدرک تحصیلی (حداکثر مدرک تحصیلی افراد شرکت کننده)</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>حداکثر مدرک تحصیلی</th>
                    <th>تعداد سفارشات</th>
                </tr>
            </thead>
            <tbody>
                {% for education in education_max_stats %}
                <tr>
                    <td>{{ education.education_max_attendees }}</td>
                    <td>{{ education.count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>تعداد سفارشات با توجه به جنسیت حاظرین در روضه</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>جنسیت</th>
                    <th>تعداد سفارشات</th>
                </tr>
            </thead>
            <tbody>
                {% for gender in gender_stats %}
                <tr>
                    <td>{{ gender.gender_attendees }}</td>
                    <td>{{ gender.count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h2>تعداد سفارشات به تفکیک هفته انتخاب شده</h2>
        <form method="get" class="mt-4">
            <div class="form-group">
                <label for="week">انتخاب هفته:</label>
                <select id="week" name="week" class="form-control">
                    {% for week in weeks %}
                    <option value="{{ week.togregorian|date:"Y-m-d" }}" {% if week.togregorian|date:"Y-m-d"|check_selected_date == selected_week|check_selected_date %}selected{% endif %}>
                        {{ week.year }}-{{ week.month }}-{{ week.day }}
                    </option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit" class="btn btn-primary">نمایش گزارش</button>
        </form>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>روز</th>
                    <th>تعداد سفارشات</th>
                </tr>
            </thead>
            <tbody>
                {% for day, count in weekday_counts.items %}
                <tr>
                    <td>{{ day }}</td>
                    <td>{{ count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OG">
